!function(){"use strict";var e=wp.blocks,t=lodash,n=wp.i18n,a=wp.blockEditor,r=wp.data,l=wp.components,i=wp.element,o=wp.dom;function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){o=!0,l=e},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw l}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function d(e,n){return(0,r.useSelect)((function(l){var i,c=l(a.store),d=c.getBlockAttributes,u=c.getBlockName,m=c.getClientIdsWithDescendants,h=c.getSettings,p=(0,r.useDispatch)("core/reusable-blocks").__experimentalConvertBlockToStatic,f=m(),v=[],g=0,b=[],k=s(f);try{var y=function(){var a=i.value,r=u(a);if("core/block"===r){var l=d(a);if(!(0,t.isNull)(l.ref)){var s=wp.data.select("core").getEditedEntityRecord("postType","wp_block",l.ref),c=(0,t.map)(s.blocks,(function(e){return e.name}));(0,t.includes)(c,"rank-math/toc-block")&&!(0,t.isNull)(d(a))&&p(a)}return 0}if(!(0,t.includes)(["rank-math/faq-block","rank-math/howto-block","core/heading"],r))return 0;var m=d(a);if("rank-math/faq-block"===r||"rank-math/howto-block"===r){var f=m.titleWrapper;if((0,t.includes)(n,f)||(0,t.includes)(["div","p"],f))return 0;var k="rank-math/howto-block"===r?m.steps:m.questions;return(0,t.isEmpty)(k)||(0,t.forEach)(k,(function(n){var a=(0,t.isUndefined)(e)||(0,t.isEmpty)(e[v.length])?{content:"",level:"",disable:!1,isUpdated:!1,isGeneratedLink:!0}:e[v.length],r=!(0,t.isUndefined)(a.isGeneratedLink)&&a.isGeneratedLink,l=!(0,t.isUndefined)(a.isUpdated)&&a.isUpdated?a.content:n.title;v.push({key:n.id,content:(0,o.__unstableStripHTML)(l),level:parseInt(m.titleWrapper.replace("h","")),link:r?"#".concat(n.id):a.link,disable:!!a.disable&&a.disable,isUpdated:!(0,t.isUndefined)(a.isUpdated)&&a.isUpdated,isGeneratedLink:r})})),0}if("core/heading"===r){if((0,t.includes)(n,"h"+m.level))return 0;var y=(0,t.isUndefined)(e)||(0,t.isEmpty)(e[v.length])?{content:"",level:"",disable:!1,isUpdated:!1,isGeneratedLink:!0}:e[v.length],w=!(0,t.isUndefined)(y.isGeneratedLink)&&y.isGeneratedLink,E=h(),_=(0,t.isEmpty)(m.content.text)?m.content:m.content.text,S=function(e,n,a,r){return(0,t.isEmpty)(e)&&((0,t.isUndefined)(r.generateAnchors)||!0!==r.generateAnchors)&&a?(0,t.kebabCase)((0,o.__unstableStripHTML)(n)):e}(m.anchor,_,w,E);(0,t.includes)(b,S)&&(S=S+"-"+(g+=1)),b.push(S),m.anchor=S;var H=(0,t.isString)(_)?(0,o.__unstableStripHTML)(_.replace(/(<br *\/?>)+/g," ")):"",x=!(0,t.isUndefined)(y.isUpdated)&&y.isUpdated?y.content:H;v.push({key:a,content:(0,o.__unstableStripHTML)(x),level:m.level,link:w?"#".concat(m.anchor):y.link,disable:!!y.disable&&y.disable,isUpdated:!(0,t.isUndefined)(y.isUpdated)&&y.isUpdated,isGeneratedLink:w})}};for(k.s();!(i=k.n()).done;)y()}catch(e){k.e(e)}finally{k.f()}return(0,t.isEqual)(e,v)?null:v}))}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return(0,t.forEach)(e,(function(a,r){var l;if(!(0,t.isEmpty)(a.content)&&a.level===e[0].level)if((null===(l=e[r+1])||void 0===l?void 0:l.level)>a.level){for(var i=e.length,o=r+1;o<e.length;o++)if(e[o].level===a.level){i=o;break}n.push({heading:a,children:u(e.slice(r+1,i))})}else n.push({heading:a,children:null})})),n}function m(e){var r=e.headings,i=void 0===r?{}:r,o=e.onHeadingUpdate,s=void 0===o?{}:o,c=e.edit,d=void 0===c?{}:c,u=e.toggleEdit,h=void 0===u?{}:u,p=e.hideHeading,f=void 0===p?{}:p,v=e.ListStyle,g=void 0===v?"ul":v,b=e.isSave,k=void 0!==b&&b;return(0,t.isEmpty)(i)?null:wp.element.createElement(React.Fragment,null,i.map((function(e){if(k&&e.heading.disable)return!1;var t=e.heading,r=t.content,i=t.link,o=t.disable,c=t.key,u="div"===g?"div":"li";return wp.element.createElement(u,{key:c,className:o?"disabled":""},k&&wp.element.createElement("a",{href:i},r),!k&&wp.element.createElement(a.RichText,{tagName:"a",value:r,allowedFormats:[],onChange:function(e){return s(e,c,!0)},placeholder:(0,n.__)("Heading text","rank-math")}),e.children&&wp.element.createElement(g,null,wp.element.createElement(m,{headings:e.children,onHeadingUpdate:s,edit:d,toggleEdit:h,hideHeading:f,ListStyle:g,isSave:k})),c===d&&wp.element.createElement(l.TextControl,{placeholder:(0,n.__)("Heading Link","rank-math"),value:i,onChange:function(e){return s(e,c)}}),!k&&wp.element.createElement("span",{className:"rank-math-block-actions"},wp.element.createElement(l.Button,{icon:d===c?"saved":"admin-links",className:"rank-math-item-visbility",onClick:function(){return h(d!==c&&c)},title:(0,n.__)("Edit Link","rank-math")}),wp.element.createElement(l.Button,{className:"rank-math-item-delete",icon:o?"hidden":"visibility",onClick:function(){return f(!o,c)},title:(0,n.__)("Hide","rank-math")})))})))}var h=function(e){var r=e.attributes,i=e.setAttributes,o=e.excludeHeadings,s=e.setExcludeHeadings;return wp.element.createElement(a.InspectorControls,null,wp.element.createElement(l.PanelBody,{title:(0,n.__)("Settings","rank-math")},wp.element.createElement(l.SelectControl,{label:(0,n.__)("Title Wrapper","rank-math"),value:r.titleWrapper,options:[{value:"h2",label:(0,n.__)("H2","rank-math")},{value:"h3",label:(0,n.__)("H3","rank-math")},{value:"h4",label:(0,n.__)("H4","rank-math")},{value:"h5",label:(0,n.__)("H5","rank-math")},{value:"h6",label:(0,n.__)("H6","rank-math")},{value:"p",label:(0,n.__)("P","rank-math")},{value:"div",label:(0,n.__)("DIV","rank-math")}],onChange:function(e){i({titleWrapper:e})}}),wp.element.createElement("br",null),wp.element.createElement("h3",null,(0,n.__)("Exclude Headings","rank-math")),wp.element.createElement("div",{className:"rank-math-toc-exclude-headings"},(0,t.map)(["h1","h2","h3","h4","h5","h6"],(function(e){return wp.element.createElement(l.CheckboxControl,{key:e,label:(0,n.__)("Heading ","rank-math")+(0,t.toUpper)(e),checked:(0,t.includes)(o,e),onChange:function(t){return s(e,t)}})})))))},p=React;function f(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=f(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}var v=function(){for(var e,t,n=0,a="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=f(e))&&(a&&(a+=" "),a+=t);return a};const g=e=>(0,i.createElement)("path",e),b=(0,i.forwardRef)((({className:e,isPressed:t,...n},a)=>{const r={...n,className:v(e,{"is-pressed":t})||void 0,"aria-hidden":!0,focusable:!1};return(0,i.createElement)("svg",{...r,ref:a})}));b.displayName="SVG";var k=(0,p.createElement)(b,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,p.createElement)(g,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM6 13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-7c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}));var y=(0,p.createElement)(b,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,p.createElement)(g,{d:"M11.1 15.8H20v-1.5h-8.9v1.5zm0-8.6v1.5H20V7.2h-8.9zM5 6.7V10h1V5.3L3.8 6l.4 1 .8-.3zm-.4 5.7c-.3.1-.5.2-.7.3l.1 1.1c.2-.2.5-.4.8-.5.3-.1.6 0 .7.1.2.3 0 .8-.2 1.1-.5.8-.9 1.6-1.4 2.5h2.7v-1h-1c.3-.6.8-1.4.9-2.1.1-.3 0-.8-.2-1.1-.5-.6-1.3-.5-1.7-.4z"}));var w=(0,p.createElement)(b,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,p.createElement)(g,{d:"M13 5.5H4V4h9v1.5Zm7 7H4V11h16v1.5Zm-7 7H4V18h9v1.5Z"})),E=function(e){var t=e.setAttributes;return wp.element.createElement(a.BlockControls,null,wp.element.createElement(l.Toolbar,{label:(0,n.__)("Table of Content Options","rank-math")},wp.element.createElement(l.ToolbarButton,{icon:k,label:(0,n.__)("Unordered List","rank-math"),onClick:function(){return t({listStyle:"ul"})}}),wp.element.createElement(l.ToolbarButton,{icon:y,label:(0,n.__)("Ordered List","rank-math"),onClick:function(){return t({listStyle:"ol"})}}),wp.element.createElement(l.ToolbarButton,{icon:w,label:(0,n.__)("None","rank-math"),onClick:function(){return t({listStyle:"div"})}})))};function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l,i,o=[],s=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=l.call(n)).done)&&(o.push(a.value),o.length!==t);s=!0);}catch(e){c=!0,r=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},H.apply(null,arguments)}var x={attributes:{title:{type:"text"},headings:{type:"array",items:{type:"object"}},listStyle:{type:"text"},titleWrapper:{type:"text",default:"h2"},excludeHeadings:{type:"array"}},save:function(e){var t=e.attributes;if(0===t.headings.length)return null;var n=t.titleWrapper,r=u(t.headings),l=t.listStyle;return wp.element.createElement("div",a.useBlockProps.save(),t.title&&wp.element.createElement(n,{dangerouslySetInnerHTML:{__html:t.title}}),wp.element.createElement("nav",null,wp.element.createElement(l,null,wp.element.createElement(m,{headings:r,ListStyle:l,isSave:!0}))))}},U=[x];(0,e.registerBlockType)("rank-math/toc-block",{edit:function(e){var o,s=e.attributes,c=e.setAttributes,p=(0,a.useBlockProps)(),f=_((0,i.useState)(!1),2),v=f[0],g=f[1],b=_((0,i.useState)({}),2),k=b[0],y=b[1];s.listStyle||c({listStyle:rankMath.listStyle});var w=s.listStyle,S=null!==(o=s.title)&&void 0!==o?o:rankMath.tocTitle,H=(0,t.isUndefined)(s.excludeHeadings)?rankMath.tocExcludeHeadings:s.excludeHeadings,x=function(e){(0,t.includes)(H,e)?(0,t.remove)(H,(function(t){return t===e})):H.push(e),c({excludeHeadings:H}),y(!k)},U=(0,r.useDispatch)(a.store).__unstableMarkNextChangeAsNotPersistent,A=d(s.headings,H);(0,i.useEffect)((function(){null!==A&&(U(),c({headings:A}))}),[A]);var C=u(s.headings);return(0,t.isUndefined)(s.headings)||0===s.headings.length?wp.element.createElement("div",p,wp.element.createElement(l.Placeholder,{label:(0,n.__)("Table of Contents","rank-math"),instructions:(0,n.__)("Add Heading blocks to this page to generate the Table of Contents.","rank-math")}),wp.element.createElement(h,{attributes:s,setAttributes:c,excludeHeadings:H,setExcludeHeadings:x})):wp.element.createElement("div",p,wp.element.createElement(a.RichText,{tagName:s.titleWrapper,value:S,onChange:function(e){c({title:e})},placeholder:(0,n.__)("Enter a title","rank-math")}),wp.element.createElement("nav",null,wp.element.createElement(w,null,wp.element.createElement(m,{headings:C,onHeadingUpdate:function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=(0,t.map)(s.headings,(function(t){return t.key===n&&(a?(t.content=e,t.isUpdated=!0):(t.isGeneratedLink=!1,t.link=e)),t}));c({headings:r})},edit:v,toggleEdit:g,hideHeading:function(e,n){var a=(0,t.map)(s.headings,(function(t){return t.key===n&&(t.disable=e),t}));c({headings:a})},ListStyle:w}))),wp.element.createElement(E,{setAttributes:c}),wp.element.createElement(h,{attributes:s,setAttributes:c,excludeHeadings:H,setExcludeHeadings:x}))},save:function(e){var n=e.attributes;if((0,t.isUndefined)(n.headings)||0===n.headings.length)return null;var r=n.titleWrapper,l=u(n.headings),i=n.listStyle;return wp.element.createElement("div",H({},a.useBlockProps.save(),{id:"rank-math-toc"}),n.title&&wp.element.createElement(r,{dangerouslySetInnerHTML:{__html:n.title}}),wp.element.createElement("nav",null,wp.element.createElement(i,null,wp.element.createElement(m,{headings:l,ListStyle:i,isSave:!0}))))},deprecated:U})}();